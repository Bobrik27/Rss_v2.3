---
import LanguagePicker from './LanguagePicker.astro';
import { content } from '../i18n/content';

interface Props {
  lang: string;
}

const { lang } = Astro.props;
const { pathname } = Astro.url;

const validLang = (['en', 'de', 'ru'] as const).includes(lang as any) ? lang as keyof typeof content : 'ru';
const translations = content[validLang];

const navItems = [
  { name: "Услуги", href: "#solutions" },
  { name: "Кейсы", href: "#cases" },
  { name: "Блог", href: "/blog" },
  { name: "IT Новости", href: "/news" },
];
---

<header class="fixed top-0 z-50 w-full border-b border-white/5 bg-background/80 backdrop-blur-xl transition-all">
  <div class="mx-auto flex h-16 max-w-7xl items-center justify-between px-6">
    <!-- Logo -->
    <a href="/" class="flex items-center gap-2 group">
      <!-- Icon (Optional, can be removed if strictly text) -->
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-6 w-6 text-primary transition-transform group-hover:rotate-12"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/></svg>
      
      <span class="text-xl font-bold tracking-tight text-foreground">
        Run Swift <span class="text-primary">Studio</span>
      </span>
    </a>

    <!-- Desktop Navigation -->
    <nav class="hidden md:flex items-center gap-8">
      {navItems.map((item) => {
        // Простая логика активности (можно усложнить для якорей через JS, но пока так)
        const isActive = pathname === item.href || (item.href !== '/' && pathname.startsWith(item.href));
        
        return (
          <a
            href={item.href}
            class={`relative flex items-center gap-2 text-sm font-medium transition-colors hover:text-primary ${isActive ? "text-foreground" : "text-muted-foreground"}`}
          >
            {isActive && (
              <span class="absolute -left-3 h-1.5 w-1.5 rounded-full bg-primary shadow-[0_0_8px_rgba(34,211,238,0.8)]"></span>
            )}
            {item.name}
          </a>
        );
      })}
    </nav>

    <!-- CTA Button -->
    <div class="flex items-center gap-4">
      <LanguagePicker lang={lang} />
      <a
        href="https://t.me/RunSwiftStudio_Bot"
        target="_blank"
        rel="noopener noreferrer"
        class="hidden sm:inline-flex h-9 items-center justify-center rounded-full border border-border bg-card/50 px-4 py-2 text-sm font-medium text-foreground transition-all hover:bg-primary/10 hover:border-primary/50 hover:text-primary"
      >
        {translations.hero.cta}
      </a>
    </div>
  </div>
</header>