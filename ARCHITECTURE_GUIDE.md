# Архитектурное руководство проекта "Run Swift Studio v3"

## Общая информация

### Название проекта: Run Swift Studio v3 (RSS_v2.3)
- **Тип проекта:** Портфолио-сайт с блогом и новостями
- **Фреймворк:** Astro v5
- **Языки программирования:** TypeScript, React 19
- **Стили:** Tailwind CSS v4
- **Цель:** Создание высокопроизводительного портфолио-сайта с поддержкой мультиязычности и контентных коллекций

## Структура проекта

### Основные директории
- `src/` - основной код приложения
  - `components/` - компоненты приложения
    - `interactive/` - интерактивные React-компоненты
    - `landing/` - компоненты главной страницы
    - `sections/` - компоненты секций
    - `wb-audit/` - компоненты WB Audit инструмента
  - `content/` - коллекции контента (блог, новости)
  - `data/` - статические данные
  - `i18n/` - словари переводов
  - `layouts/` - макеты страниц
  - `pages/[lang]/` - локализованные маршруты
    - `tools/wb-audit.astro` - страница WB Audit инструмента
  - `styles/` - глобальные стили
  - `config/` - конфигурационные файлы
- `public/` - статические ресурсы (изображения, иконки)
- `source/` - старые версии и вспомогательные файлы (Word-документы, старые версии сайта)

### Старые версии
- `source/old_page/` - старая версия сайта на чистом HTML/CSS/JS
- `source/old_page2/` - предыдущая версия на Astro с React и Tailwind

## Зависимости

### Основные зависимости
- `astro` - фреймворк для создания веб-приложений
- `@astrojs/react` - интеграция React с Astro
- `react`, `react-dom` - библиотека для создания пользовательских интерфейсов
- `tailwindcss` - фреймворк для стилей
- `@tailwindcss/vite` - плагин для интеграции Tailwind с Vite
- `lucide-react` - иконки
- `@types/react`, `@types/react-dom` - типы для React
- `typescript` - язык программирования

## Архитектура компонентов

### Astro-компоненты
- Используются по умолчанию для структуры, макетов и статического контента
- Файлы с расширением `.astro`
- Используются для лейаутов, статических секций

### React-компоненты
- Используются ТОЛЬКО для сложной интерактивности
- Файлы с расширением `.jsx` или `.tsx`
- Примеры: Hero-анимации, калькуляторы, переключатель темы
- Используются с островной архитектурой Astro (`client:*`)

### Islands архитектура
- Используется директива `client:visible` для тяжелых компонентов
- Минимизация работы Main Thread
- Используется `client:only="react"` для компонентов, требующих полной гидратации

## Стили и темизация

### Tailwind CSS v4
- Используется без `tailwind.config.js`
- Все настройки в `src/styles/global.css` через `@theme`
- Используются цвета в формате oklch для темной/светлой темы

### Цветовая схема
- Основная тема: "SaaS Dark/Light" (Deep Slate/Cyan)
- Темная тема по умолчанию (чтобы избежать вспышки белого при загрузке)
- Переключение через атрибут `data-theme="dark/light"`
- Использование CSS-переменных для управления цветами

#### Темные тона:
- `--color-background`: rgb(17, 15, 8)
- `--color-surface`: oklch(0.20 0.05 260)
- `--color-surface-elevated`: oklch(0.25 0.05 260)
- `--color-card`: rgb(25, 22, 13)
- `--color-card-foreground`: oklch(0.92 0.02 95)
- `--color-text`: oklch(0.92 0.02 95)
- `--color-text-muted`: oklch(0.70 0.02 95)
- `--color-primary`: oklch(0.72 0.12 190) (Туркуазовый акцент)
- `--color-primary-hover`: oklch(0.78 0.12 190)
- `--color-secondary`: oklch(0.65 0.18 35) (Оранжевый брендовый)
- `--color-secondary-hover`: oklch(0.70 0.18 35)
- `--color-accent`: oklch(0.85 0.10 150) (Мятный для акцентов)
- `--color-border`: oklch(0.32 0.01 95)
- `--color-success`: oklch(0.75 0.15 145)
- `--color-warning`: oklch(0.80 0.18 75)
- `--color-error`: oklch(0.75 0.20 25)

#### Светлые тона:
- `--color-background`: oklch(0.98 0.01 260) (Почти белый)
- `--color-surface`: oklch(0.95 0.01 260)
- `--color-surface-elevated`: oklch(0.92 0.01 260)
- `--color-card`: oklch(0.99 0.006 95) (Светлая карточка)
- `--color-card-foreground`: oklch(0.26 0.03 95)
- `--color-text`: oklch(0.15 0.05 260) (Темно-серый)
- `--color-text-muted`: oklch(0.40 0.05 260)
- `--color-primary`: oklch(0.55 0.12 190) (Более насыщенный туркуаз)
- `--color-primary-hover`: oklch(0.60 0.12 190)
- `--color-secondary`: oklch(0.55 0.18 35) (Оранжевый)
- `--color-secondary-hover`: oklch(0.60 0.18 35)
- `--color-accent`: oklch(0.65 0.10 150)
- `--color-border`: oklch(0.85 0.02 260)
- `--color-success`: oklch(0.60 0.15 145)
- `--color-warning`: oklch(0.65 0.18 75)
- `--color-error`: oklch(0.65 0.20 25)

### Глобальные стили
- Файл: `src/styles/global.css`
- Определение цветов и темы через `@theme`
- Базовые стили и слои (layers)
- Шрифты: Inter (sans), JetBrains Mono (mono)
- Радиусы: sm(0.25rem), md(0.5rem), lg(1rem), xl(1.5rem)
- Анимации: fade-in, slide-up

## Компоненты

### Структура главной страницы
- Статический герой (StaticHero)
- О студии (About)
- Услуги (Services)
- Компетенции (Competencies)
- Решения (Solutions)
- Подход (Approach)
- Команда (Team)
- Призыв к действию (CTA)

### WBAuditWidget
- Комплексный React-компонент для аудита товаров Wildberries
- Включает в себя 6 модулей анализа:
  - Маркетинговый анализ
  - Автономные агенты
  - Vibe-coding
  - Совет AI
  - Базы данных
  - Нейросети
- Интеграция с n8n и Python Core через webhook-эндпоинты
- Интерактивный интерфейс с терминалом и анимацией процесса
- Поддержка загрузки результатов анализа

### Основные файлы и их функции

#### src/components/wb-audit/WBAuditWidget.tsx
- инициализацию состояния компонента (view, auditState, url, progress, logs, productData)
- валидацию и извлечение SKU из URL Wildberries
- вызов эндпоинта parse для получения данных о продукте
- вызов эндпоинта trigger для запуска полного аудита
- периодический опрос статуса аудита с обновлением прогресса
- отображение терминала с логами процесса
- отображение результата анализа с возможностью скачивания
- обработку ошибок и состояний загрузки

#### src/config/api.ts
- определение базового URL для API
- определение эндпоинтов для парсинга, триггера и статуса
- обеспечение интеграции с n8n workflow

#### src/pages/[lang]/tools/wb-audit.astro
- маршрутизацию страницы инструмента аудита
- генерацию статических путей для мультиязычности
- рендеринг компонента WBAuditWidget

#### src/components/Header.astro
- отображение навигационного меню
- переключение языков интерфейса
- навигацию по разделам сайта
- отображение логотипа и кнопки связи

#### src/layouts/Layout.astro
- предоставление общего макета для всех страниц
- подключение глобальных стилей
- встраивание Header и Footer
- установку атрибутов темы

#### src/pages/[lang]/index.astro
- генерацию статических путей для мультиязычности
- рендеринг главной страницы с компонентами
- предоставление основного маршрута приложения

#### src/components/StaticHero.astro
- отображение заголовка главной страницы
- рендеринг призывов к действию
- предоставление анимаций и визуальных эффектов

#### src/content/config.ts
- определение схем для контентных коллекций (блог, новости)
- валидацию данных через Zod
- обеспечение типизации контента

#### src/i18n/content.ts
- предоставление переводов для различных языков
- локализацию интерфейсных элементов
- поддержку мультиязычности в приложении

#### astro.config.mjs
- конфигурацию Astro фреймворка
- настройку интеграций (React, Tailwind, Markdown)
- определение параметров сборки
- маршрутизацию и обработку статических файлов

## Структура данных (src/data/landing.ts)
- Компетенции: архитектура, процессы, инфраструктура, ИИ, Telegram, гарантия
- Решения: SMM-экосистемы, Telegram-платформы, ИИ-ассистенты, аудит и рефакторинг
- О студии: информация и статистика
- Подход: анализ, прототипирование, реализация, поддержка
- Призыв к действию

## AI Agency Core (_core_remote)

### Обзор
Директория `_core_remote` содержит инфраструктуру бэкенда для AI Agency Operating System - сложной системы автономных агентов, построенной с использованием CrewAI и FastAPI. Эта система обрабатывает основную бизнес-логику для аудита, анализа и отчетности с помощью ИИ.

### Технологический стек
- **Основной фреймворк**: CrewAI для многопользовательских систем агентов
- **API уровень**: FastAPI для REST-эндпоинтов
- **Контейнеризация**: Docker & docker-compose
- **Генерация PDF**: WeasyPrint с шаблонами Jinja2
- **Обработка данных**: PyYAML, JSON, Pandas
- **Безопасность**: Аутентификация с помощью токенов сервиса
- **Поддержка LLM**: OpenAI GPT, Google Gemini, Groq, DeepSeek, xAI Grok

### Ключевые компоненты

#### Основная архитектура
- **main.py**: Центральный двигатель, координирующий рабочие процессы агентов, включая выполнение конвейера, финансовые расчеты и постобработку
- **api.py**: Приложение FastAPI, обрабатывающее HTTP-запросы, фоновые задачи и обратные вызовы вебхуков
- **state_manager.py**: Управление состоянием проекта с механизмами блокировки и хранением паспортных данных
- **agent_factory.py**: Фабрика LLM с механизмами отката и загрузчиком конфигурации агента
- **pdf_engine.py**: Генерация PDF из Markdown с лицензионными уровнями и водяными знаками

#### Инструменты
- **wb_scraper.py**: Скребок данных о товарах Wildberries с интеграцией API и альтернативными данными
- **review_scraper.py**: Скребок отзывов Google Maps/TripAdvisor с функцией альтернативных данных
- **asset_manager.py**: Управление ресурсами для файлов проекта и ресурсов

#### Ростовщик агентов
- **wb_analyst.yaml**: Старший аудитор данных Wildberries для механического извлечения фактов
- **wb_writer.yaml**: Компилятор технических отчетов для форматирования PDF
- **wb_scraper_agent.yaml**: Сборщик данных Wildberries для получения информации о продуктах
- **Множество специализированных агентов**: Включая builder_devops, cfo_guardian, closer_shark, diagnostic_prime и другие

#### Рабочие процессы
- **WB Audit Flow**: Процесс анализа продукта и составления отчетов
- **Enterprise OS Flow**: Многоэтапный бизнес-анализ (открытие, стратегия, архитектура, коммерция, передача)
- **Review Detective Flow**: Анализ отзывов и расследование мнений

#### Конфигурация
- **.env.example**: Шаблон для переменных среды и ключей API
- **requirements.txt**: Зависимости для ядра ИИ, уровня API, устаревшего UI и движка PDF
- **Dockerfile**: Настройка контейнера с системными зависимостями для генерации PDF
- **docker-compose.yml**: Оркестрация многосервисной системы для ядра ИИ

### Особенности
- **Автономные конвейеры**: Многоступенчатый бизнес-анализ с автоматическим прогрессом
- **Оркестровка LLM**: Гибкая конфигурация агента с откатом модели
- **Отслеживание статуса в реальном времени**: Мониторинг прогресса с индикаторами фазы
- **Финансовые расчеты**: Метрики ROI и расчеты периода окупаемости
- **Лицензирование нескольких уровней**: Уровни гостя, начинающего, бизнеса и премиум
- **Безопасная аутентификация**: Контроль доступа на основе токенов службы
- **Асинхронная обработка**: Выполнение фоновых задач с ограничением ресурсов
- **Альтернативные данные**: Устойчивая работа при недоступности внешних API